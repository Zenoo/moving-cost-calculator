class MovingCostCalculator{constructor(target,parameters){if(this._wrapper=target instanceof Element?target:document.querySelector(target),!this._wrapper)throw new Error("MovingCostCalculator: "+("string"==typeof target?"The selector `"+target+"` didn't match any element.":"The element you provided was undefined"));if(this._wrapper.classList.contains("mcc-wrapper"))throw new Error("MovingCostCalculator: The element has already been initialized.");this._parameters={lang:"en",debug:!1,...parameters},this._loadDictionary(),this._loadDependencies().then(()=>{this._parameters.debug&&console.log("MovingCostCalculator: DEPENDENCIES LOADED !"),this._build(),this._listen()})}_loadDependencies(){this._parameters.debug&&console.log("MovingCostCalculator: LOADING DEPENDENCIES ...");const movingVolumeCalculatorDependency=new Promise(solve=>{if("function"==typeof MovingVolumeCalculator)solve();else{const movingVolumeCalculatorScript=new Promise(resolve=>{this._loadResource("script","https://gitcdn.link/repo/Zenoo/moving-volume-calculator/master/MovingVolumeCalculator.min.js",()=>{this._parameters.debug&&console.log("DEPENDENCIES: MovingVolumeCalculator script LOADED !"),resolve()})}),movingVolumeCalculatorStyle=new Promise(resolve=>{this._loadResource("style","https://gitcdn.link/repo/Zenoo/moving-volume-calculator/master/MovingVolumeCalculator.min.css",()=>{this._parameters.debug&&console.log("DEPENDENCIES: MovingVolumeCalculator style LOADED !"),resolve()})});Promise.all([movingVolumeCalculatorScript,movingVolumeCalculatorStyle]).then(()=>{solve()})}}),googleMapsAPIDependency=new Promise(solve=>{if(window.google&&window.google.maps)solve();else{const gMapScript=document.querySelector('script[src^="https://maps.googleapis.com"]');gMapScript&&(gMapScript.remove(),google&&Reflect.deleteProperty(google,"maps"));const newAPI=document.createElement("script");if(!this._parameters.googleAPIKey)throw new Error("MovingCostCalculator: You didn't provide your Google Maps API key. Please either pass it via the options' googleAPIKey attribute OR import the Google Maps API script on your own.");newAPI.src="https://maps.googleapis.com/maps/api/js?libraries=places&key="+this._parameters.googleAPIKey+"&language="+this._parameters.lang+"&callback=__mccGmapApiLoader",window.__mccGmapApiLoader=(()=>{this._parameters.debug&&console.log("DEPENDENCIES: Google Maps API script LOADED !"),solve()}),document.querySelector("head").appendChild(newAPI)}}),addressSearchDependency=new Promise(solve=>{if("function"==typeof AddressSearch)solve();else{const addressSearchScript=new Promise(resolve=>{this._loadResource("script","https://gitcdn.link/repo/Zenoo/address-search/master/address-search.min.js",()=>{this._parameters.debug&&console.log("DEPENDENCIES: AddressSearch script LOADED !"),resolve()})}),addressSearchStyle=new Promise(resolve=>{this._loadResource("style","https://gitcdn.link/repo/Zenoo/address-search/master/address-search.min.css",()=>{this._parameters.debug&&console.log("DEPENDENCIES: AddressSearch style LOADED !"),resolve()})});Promise.all([addressSearchScript,addressSearchStyle]).then(()=>{solve()})}});return Promise.all([movingVolumeCalculatorDependency,googleMapsAPIDependency,addressSearchDependency])}_loadResource(type,url,callback){const[head]=document.getElementsByTagName("head");if("script"==type){const script=document.createElement("script");script.src=url,script.onload=callback,head.appendChild(script)}else{const link=document.createElement("link");link.href=url,link.rel="stylesheet",link.type="text/css",link.onload=callback,head.appendChild(link)}}_loadDictionary(){this._dictionary={en:{title:"Estimate your moving cost",addressesTitle:"Your addresses",volumeTitle:"Your volume",estimationsTitle:"Estimations",departureAddress:"Departure address",arrivalAddress:"Arrival address",moreAddressOptions:"More options"},fr:{title:"Estimez le coût de votre déménagement",addressesTitle:"Vos addresses",volumeTitle:"Votre volume",estimationsTitle:"Estimations",departureAddress:"Adresse de départ",arrivalAddress:"Adresse d'arrivée",moreAddressOptions:"Plus d'options"}},this._dictionary=Object.assign(this._dictionary,this._parameters.dictionary||{})}_build(){this._wrapper.classList.add("mcc-wrapper");let title=document.createElement("title"),section=document.createElement("section");(title=document.createElement("h3")).innerHTML=this._translated().title,this._wrapper.appendChild(title),this._buildAddresses(),(section=document.createElement("section")).classList.add("mcc-volume"),this._wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().volumeTitle,section.appendChild(title),(section=document.createElement("section")).classList.add("mcc-loader"),this._wrapper.appendChild(section),(section=document.createElement("section")).classList.add("mcc-estimations"),this._wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().estimationsTitle,section.appendChild(title)}_buildAddresses(){let title=document.createElement("title"),section=document.createElement("section"),p=document.createElement("p"),input=document.createElement("input");(section=document.createElement("section")).classList.add("mcc-addresses"),this._wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().addressesTitle,section.appendChild(title),p.innerText=this._translated().departureAddress,section.appendChild(p),section.appendChild(input),this.departureAddress=new AddressSearch(input),(p=document.createElement("p")).innerText=this._translated().arrivalAddress,section.appendChild(p),input=document.createElement("input"),section.appendChild(input),this.arrivalAddress=new AddressSearch(input)}_listen(){}_translated(){return this._dictionary[this._parameters.lang]}setLang(lang){return this._parameters.lang=lang||"en",this}destroy(){this._wrapper.innerHTML="",this._wrapper.classList.remove("mcc-wrapper")}static destroy(selector){const element=document.querySelector(selector);element&&element.classList.contains("mcc-wrapper")&&(element.innerHTML="",element.classList.remove("mcc-wrapper"))}}