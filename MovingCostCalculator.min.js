class MovingCostCalculator{constructor(target,parameters){if(this._elements={wrapper:null,departure:{address:null,options:{floor:null,lift:null,furnitureLift:null,porterageDistance:null}},arrival:{address:null,options:{floor:null,lift:null,furnitureLift:null,porterageDistance:null}}},this._elements.wrapper=target instanceof Element?target:document.querySelector(target),!this._elements.wrapper)throw new Error("MovingCostCalculator: "+("string"==typeof target?"The selector `"+target+"` didn't match any element.":"The element you provided was undefined"));if(this._elements.wrapper.classList.contains("mcc-wrapper"))throw new Error("MovingCostCalculator: The element has already been initialized.");this._parameters={lang:"en",debug:!1,...parameters},this.data={addresses:{departure:{value:"",options:{floor:0,lift:!1,furnitureLift:!1,porterageDistance:5}},arrival:{value:"",options:{floor:0,lift:!1,furnitureLift:!1,porterageDistance:5}}}},this._loadDictionary(),this._loadDependencies().then(()=>{this._parameters.debug&&console.log("MovingCostCalculator: DEPENDENCIES LOADED !"),this._build(),this._listen()})}_loadDependencies(){this._parameters.debug&&console.log("MovingCostCalculator: LOADING DEPENDENCIES ...");const movingVolumeCalculatorDependency=new Promise(solve=>{if("function"==typeof MovingVolumeCalculator)solve();else{const movingVolumeCalculatorScript=new Promise(resolve=>{this._loadResource("script","https://gitcdn.link/repo/Zenoo/moving-volume-calculator/master/MovingVolumeCalculator.min.js",()=>{this._parameters.debug&&console.log("DEPENDENCIES: MovingVolumeCalculator script LOADED !"),resolve()})}),movingVolumeCalculatorStyle=new Promise(resolve=>{this._loadResource("style","https://gitcdn.link/repo/Zenoo/moving-volume-calculator/master/MovingVolumeCalculator.min.css",()=>{this._parameters.debug&&console.log("DEPENDENCIES: MovingVolumeCalculator style LOADED !"),resolve()})});Promise.all([movingVolumeCalculatorScript,movingVolumeCalculatorStyle]).then(()=>{solve()})}}),googleMapsAPIDependency=new Promise(solve=>{if(window.google&&window.google.maps)solve();else{const gMapScript=document.querySelector('script[src^="https://maps.googleapis.com"]');gMapScript&&(gMapScript.remove(),google&&Reflect.deleteProperty(google,"maps"));const newAPI=document.createElement("script");if(!this._parameters.googleAPIKey)throw new Error("MovingCostCalculator: You didn't provide your Google Maps API key. Please either pass it via the options' googleAPIKey attribute OR import the Google Maps API script on your own.");newAPI.src="https://maps.googleapis.com/maps/api/js?libraries=places&key="+this._parameters.googleAPIKey+"&language="+this._parameters.lang+"&callback=__mccGmapApiLoader",window.__mccGmapApiLoader=(()=>{this._parameters.debug&&console.log("DEPENDENCIES: Google Maps API script LOADED !"),solve()}),document.querySelector("head").appendChild(newAPI)}}),addressSearchDependency=new Promise(solve=>{if("function"==typeof AddressSearch)solve();else{const addressSearchScript=new Promise(resolve=>{this._loadResource("script","https://gitcdn.link/repo/Zenoo/address-search/master/address-search.min.js",()=>{this._parameters.debug&&console.log("DEPENDENCIES: AddressSearch script LOADED !"),resolve()})}),addressSearchStyle=new Promise(resolve=>{this._loadResource("style","https://gitcdn.link/repo/Zenoo/address-search/master/address-search.min.css",()=>{this._parameters.debug&&console.log("DEPENDENCIES: AddressSearch style LOADED !"),resolve()})});Promise.all([addressSearchScript,addressSearchStyle]).then(()=>{solve()})}});return Promise.all([movingVolumeCalculatorDependency,googleMapsAPIDependency,addressSearchDependency])}_loadResource(type,url,callback){const[head]=document.getElementsByTagName("head");if("script"==type){const script=document.createElement("script");script.src=url,script.onload=callback,head.appendChild(script)}else{const link=document.createElement("link");link.href=url,link.rel="stylesheet",link.type="text/css",link.onload=callback,head.appendChild(link)}}_loadDictionary(){this._dictionary={en:{title:"Estimate your moving cost",addressesTitle:"Your addresses",volumeTitle:"Your volume",estimationsTitle:"Estimations",departureAddress:"Departure address",arrivalAddress:"Arrival address",moreAddressOptions:"More options",floor:"Floor",lift:"Lift",furnitureLift:"Furniture Lift",porterageDistance:"Porterage Distance",yes:"Yes",no:"No"},fr:{title:"Estimez le coût de votre déménagement",addressesTitle:"Vos addresses",volumeTitle:"Votre volume",estimationsTitle:"Estimations",departureAddress:"Adresse de départ",arrivalAddress:"Adresse d'arrivée",moreAddressOptions:"Plus d'options",floor:"Etage",lift:"Ascenseur",furnitureLift:"Monte-meubles",porterageDistance:"Distance de portage",yes:"Oui",no:"Non"}},this._dictionary=Object.assign(this._dictionary,this._parameters.dictionary||{})}_build(){this._elements.wrapper.classList.add("mcc-wrapper");const title=document.createElement("h3");title.innerHTML=this._translated().title,this._elements.wrapper.appendChild(title),this._buildAddresses(),this._buildVolume(),this._buildContact(),this._buildLoader(),this._buildEstimations()}_buildAddresses(){let title=document.createElement("title"),section=document.createElement("section"),p=document.createElement("p"),input=document.createElement("input"),div=document.createElement("div");(section=document.createElement("section")).classList.add("mcc-addresses"),this._elements.wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().addressesTitle,section.appendChild(title),p.innerText=this._translated().departureAddress,section.appendChild(p),section.appendChild(input),this._elements.departure.address=new AddressSearch(input),section.appendChild(div),this._buildAddressOptions(this._elements.departure.options,div),(p=document.createElement("p")).innerText=this._translated().arrivalAddress,section.appendChild(p),input=document.createElement("input"),section.appendChild(input),this._elements.arrival.address=new AddressSearch(input),div=document.createElement("div"),section.appendChild(div),this._buildAddressOptions(this._elements.arrival.options,div)}_buildAddressOptions(options,holder){Object.keys(options).forEach(option=>{const p=document.createElement("p"),span=document.createElement("span");if(["lift","furnitureLift"].includes(option)){options[option]=document.createElement("select");let optionTag=document.createElement("option");optionTag.value="false",optionTag.innerText=this._translated().no,options[option].appendChild(optionTag),(optionTag=document.createElement("option")).value="true",optionTag.innerText=this._translated().yes,options[option].appendChild(optionTag)}else options[option]=document.createElement("input");span.innerText=this._translated()[option],p.appendChild(span),p.appendChild(options[option]),holder.appendChild(p)})}_buildVolume(){let title=document.createElement("title"),section=document.createElement("section");(section=document.createElement("section")).classList.add("mcc-volume"),this._elements.wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().volumeTitle,section.appendChild(title)}_buildContact(){let section=document.createElement("section");(section=document.createElement("section")).classList.add("mcc-contact"),this._elements.wrapper.appendChild(section)}_buildLoader(){let section=document.createElement("section");(section=document.createElement("section")).classList.add("mcc-loader"),this._elements.wrapper.appendChild(section)}_buildEstimations(){let title=document.createElement("title"),section=document.createElement("section");(section=document.createElement("section")).classList.add("mcc-estimations"),this._elements.wrapper.appendChild(section),(title=document.createElement("h4")).innerHTML=this._translated().estimationsTitle,section.appendChild(title)}_listen(){this._elements.departure.address.onSelect(address=>{this.data.departure.address=address}),this._elements.departure.options.floor.addEventListener("change",()=>{this.data.addresses.departure.options.floor=+this._elements.departure.options.floor.value}),this._elements.departure.options.lift.addEventListener("change",()=>{this.data.addresses.departure.options.lift="true"==this._elements.departure.options.lift.value}),this._elements.departure.options.furnitureLift.addEventListener("change",()=>{this.data.addresses.departure.options.furnitureLift="true"==this._elements.departure.options.furnitureLift.value}),this._elements.departure.options.porterageDistance.addEventListener("change",()=>{this.data.addresses.departure.options.porterageDistance=+this._elements.departure.options.porterageDistance.value}),this._elements.arrival.address.onSelect(address=>{this.data.arrival.address=address}),this._elements.arrival.options.floor.addEventListener("change",()=>{this.data.addresses.arrival.options.floor=+this._elements.arrival.options.floor.value}),this._elements.arrival.options.lift.addEventListener("change",()=>{this.data.addresses.arrival.options.lift="true"==this._elements.arrival.options.lift.value}),this._elements.arrival.options.furnitureLift.addEventListener("change",()=>{this.data.addresses.arrival.options.furnitureLift="true"==this._elements.arrival.options.furnitureLift.value}),this._elements.arrival.options.porterageDistance.addEventListener("change",()=>{this.data.addresses.arrival.options.porterageDistance=+this._elements.arrival.options.porterageDistance.value})}_translated(){return this._dictionary[this._parameters.lang]}setLang(lang){return this._parameters.lang=lang||"en",this}destroy(){this._elements.wrapper.innerHTML="",this._elements.wrapper.classList.remove("mcc-wrapper")}static destroy(selector){const element=document.querySelector(selector);element&&element.classList.contains("mcc-wrapper")&&(element.innerHTML="",element.classList.remove("mcc-wrapper"))}}